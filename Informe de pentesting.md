
**Fecha:** 28 de enero de 2025  
**Cliente:** Web Talent Scout  
**Realizado por:** Israel Valderrama García

---
## 1. Resumen Ejecutivo

Este informe presenta los resultados de las pruebas de penetración realizadas en la aplicación web Web Talent Scout, con el objetivo de identificar y evaluar las vulnerabilidades que podrían ser explotadas por un atacante. Durante las pruebas, se detectaron varias vulnerabilidades críticas, incluyendo una inyección SQL en el formulario de inicio de sesión, que permite el acceso no autorizado a la base de datos. Además, la aplicación carece de protección contra ataques de fuerza bruta, lo que facilita la obtención de credenciales de usuario. También se encontró que las funciones de validación de datos no son suficientes para prevenir manipulaciones maliciosas, lo que aumenta el riesgo de inyecciones SQL.

Las vulnerabilidades encontradas podrían permitir a un atacante obtener acceso no autorizado a información sensible de los usuarios, comprometer la integridad de la aplicación y llevar a cabo otros ataques dirigidos. Para mitigar estos riesgos, se recomienda la implementación de consultas SQL preparadas, fortalecer la protección contra ataques de fuerza bruta e implementar mejores prácticas en la validación de entradas.

## 2. Alcance de las pruebas

El alcance de las pruebas se centró en las siguientes áreas clave:

- **Autenticación y Gestión de Sesiones:** Evaluación de las protecciones de autenticación y la validez de las sesiones de usuario.
- **Vulnerabilidades en la Base de Datos:** Análisis de puntos de entrada donde podrían producirse inyecciones SQL y filtrado de datos.
- **Errores de Programación y Validación de Entradas:** Inspección de las funciones de validación y tratamiento de datos en la aplicación.
- **Autorización y Acceso no autorizado:** Examen de brechas de seguridad que pudieran permitir el acceso a información restringida.
## 3. Metodología utilizada

### Explotación

Durante la fase de explotación, me enfoqué en las siguientes vulnerabilidades clave que fueron detectadas:

- **Inyección SQL en el Formulario de Login (`insert_player.php`)**  
    Utilizando un enfoque manual, probé varias inyecciones SQL comunes en el campo de nombre de usuario del formulario de inicio de sesión. La consulta original era vulnerable a manipulaciones, permitiendo la evasión de la autenticación. Esto me permitió obtener acceso no autorizado a la base de datos de usuarios.    
    
    - **Comando usado:**        
        `' OR 1=1 --`         
    - **Resultado:** Se obtuvo acceso a los registros de la base de datos sin necesidad de autenticación, exponiendo información sensible.
    
- **Explotación de Fuerza Bruta**  
	Se realizó una prueba de fuerza bruta utilizando una herramienta de diccionario que contiene contraseñas comunes. No encontré mecanismos de protección contra intentos fallidos, lo que permitió realizar múltiples intentos sin restricciones. Utilicé un conjunto de contraseñas predeterminadas como "1234", "password", "qwerty", entre otras.
    
    - **Herramienta utilizada:** Manual
    - **Resultado:** Después de un número de intentos, se logró descifrar la contraseña de un usuario.
    
- **Explotación de Errores de Programación en Validación de Datos**  
	Durante la revisión de código, se encontró que la función `SQLite3::escapeString()` era utilizada para escapar datos sin un control adecuado. Esto permitió realizar ataques de inyección en las consultas SQL. Intenté inyectar caracteres especiales y cadenas que no fueron correctamente filtradas.
    
    - **Comando usado:**
        `' UNION SELECT NULL, user, password FROM users --`         
    - **Resultado:** Acceso no autorizado a la información de usuarios almacenada en la base de datos, debido a la falta de protección contra inyecciones.
    
## 4. Resultados Encontrados

### Vulnerabilidad 1: Inyección SQL (Crítica)

- **Descripción:** Se encontró que el formulario de inicio de sesión es vulnerable a inyecciones SQL, lo que permite manipular la consulta y eludir el proceso de autenticación.
- **Impacto:** Acceso completo a la base de datos de la aplicación y posible robo de datos de usuarios.
- **Recomendación:** Implementar consultas preparadas utilizando parámetros bind y sanitizar adecuadamente las entradas de usuario.

### Vulnerabilidad 2: Fuerza Bruta en el Formulario de Login (Alta)

- **Descripción:** El formulario de inicio de sesión no protege adecuadamente contra ataques de fuerza bruta, lo que facilita a un atacante la posibilidad de adivinar contraseñas mediante un diccionario de contraseñas.
- **Impacto:** Acceso no autorizado a cuentas de usuario mediante técnicas de adivinación de contraseñas.
- **Recomendación:** Implementar un sistema de bloqueo temporal después de un número de intentos fallidos para mitigar los ataques de fuerza bruta.

### Vulnerabilidad 3: Errores de Programación en la Validación de Datos (Alta)

- **Descripción:** La validación de entradas de usuario no se realiza de manera adecuada, lo que permite inyecciones SQL y la manipulación de datos.
- **Impacto:** Riesgo de ataques que comprometen la base de datos, además de la posibilidad de manipulación o robo de información sensible.
- **Recomendación:** Reemplazar `SQLite3::escapeString()` con consultas preparadas y parametrizadas para garantizar la seguridad de las consultas SQL.

### Vulnerabilidad 4: Exposición de Información Sensible (Media)

- **Descripción:** Se encontró que la aplicación expone detalles sensibles del sistema, como la versión del servidor y nombres de archivos, a través de mensajes de error y encabezados HTTP.
- **Impacto:** Información útil para un atacante que pueda explotarla para realizar un ataque dirigido.
- **Recomendación:** Configurar adecuadamente los mensajes de error y ocultar detalles sensibles de los encabezados HTTP.
## 5. Conclusiones

La aplicación Web Talent Scout presenta varias vulnerabilidades críticas que deben ser corregidas de inmediato para evitar comprometer la seguridad de los datos de los usuarios. Las principales áreas de preocupación son la inyección SQL en el formulario de inicio de sesión, la falta de protección contra ataques de fuerza bruta, y la inseguridad en la validación de datos de entrada.

Se recomienda implementar las siguientes acciones:

1. **Corregir la vulnerabilidad de inyección SQL** mediante el uso de consultas preparadas y parámetros bind.
2. **Fortalecer la protección de inicio de sesión** con un sistema de bloqueo de cuenta tras múltiples intentos fallidos.
3. **Revisar y mejorar la validación de entradas de datos** para proteger contra manipulaciones de SQL.
4. **Reconfigurar el servidor** para no exponer información sensible a través de mensajes de error o encabezados HTTP.
## 6. Recomendaciones Generales

- **Revisión periódica de seguridad** y actualizaciones de software para minimizar las posibles vulnerabilidades.
- **Implementación de autenticación multifactor (MFA)** para aumentar la seguridad de las cuentas de usuario.
- **Capacitación continua en seguridad** para el equipo de desarrollo, enfocándose en las mejores prácticas de codificación segura.

---
**Firma del Pentester:**
![[firma.png]]
**Israel Valderrama García**
**ivalgar260@g.educaand.es**

